<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Theme Toggle (Tailwind)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* --- Custom CSS kept only for global transitions and animation --- */

      /* Base transitions (essential for smooth theme change) */
      html {
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      /* Icon transition (for hover animation) */
      #theme-icon {
        transition: transform 0.3s ease;
      }

      /* Tailwind JIT/Arbitrary value can handle this, but keeping here for simplicity: */
      /* Note: In a real project, this would be a custom utility class. */
      #theme-toggle:hover #theme-icon {
        transform: scale(1.1);
      }
      
      /* Print styles */
      @media print {
        body {
          background-color: white !important;
          color: black !important;
        }

        #theme-toggle {
          display: none;
        }
      }
    </style>
    <script>
      // Function to set theme immediately based on preference or system
      (function initializeTheme() {
        const html = document.documentElement;
        const savedTheme = localStorage.getItem("theme");
        const systemPrefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

        // Apply theme without relying on DOMContentLoaded for a smooth initial load
        if (savedTheme === "dark" || (!savedTheme && systemPrefersDark)) {
          html.classList.add("dark");
        } else {
          html.classList.remove("dark");
        }
      })();

      // Wait for the full page load to attach the click listener
      document.addEventListener("DOMContentLoaded", () => {
        const themeToggle = document.getElementById("theme-toggle");
        const themeIcon = document.getElementById("theme-icon");
        const html = document.documentElement;

        if (!themeToggle || !themeIcon) return;

        // Function to update icon and localStorage (called after initialization)
        const updateIconAndStorage = (isDark) => {
          if (isDark) {
            themeIcon.className = "fas fa-sun"; // Show sun when dark (to switch to light)
            localStorage.setItem("theme", "dark");
          } else {
            themeIcon.className = "fas fa-moon"; // Show moon when light (to switch to dark)
            localStorage.setItem("theme", "light");
          }
        };

        // Set the initial icon state based on the already-applied theme class
        updateIconAndStorage(html.classList.contains('dark'));
        
        // Toggle theme on button click
        themeToggle.addEventListener("click", () => {
          const isDark = html.classList.toggle("dark"); // Toggle the class and get the new state
          updateIconAndStorage(isDark);
        });

        // Watch for system theme changes (if no localStorage preference set)
        window
          .matchMedia("(prefers-color-scheme: dark)")
          .addEventListener("change", (e) => {
            if (!localStorage.getItem("theme")) {
              const isDark = e.matches;
              isDark ? html.classList.add("dark") : html.classList.remove("dark");
              updateIconAndStorage(isDark);
            }
          });
      });
    </script>
  </head>
  <body
    class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-50 min-h-screen"
  >
    <div class="container mx-auto px-4 py-8 max-w-3xl">
      <header class="flex justify-between items-center mb-8">
        <div>
          <h1 class="text-3xl font-bold">Theme Switcher (Tailwind)</h1>
          <p class="text-gray-600 dark:text-gray-400">
            Toggle between dark and light mode
          </p>
        </div>
        <button
          id="theme-toggle"
          aria-label="Toggle theme"
          class="p-3 rounded-full bg-gray-200 dark:bg-gray-700 transition hover:bg-gray-300 dark:hover:bg-gray-600 focus-visible:outline-2 focus-visible:outline-blue-500 focus-visible:outline-offset-2 shadow-md"
        >
          <i id="theme-icon" class="fas fa-moon"></i>
        </button>
      </header>

      <main>
        <section
          class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 mb-6"
        >
          <h2 class="text-2xl font-semibold mb-4">Demo Content</h2>
          <p class="mb-4 text-gray-700 dark:text-gray-300">
            This theme switcher:
          </p>
          <ul class="list-disc pl-5 space-y-2 text-gray-700 dark:text-gray-300">
            <li>Saves your preference using **localStorage**</li>
            <li>Respects your system color scheme via **`matchMedia`**</li>
            <li>Works on all devices and has smooth **transitions**</li>
          </ul>
        </section>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
            <h3 class="font-medium mb-3">Card Example</h3>
            <p class="text-gray-700 dark:text-gray-300">
              This card adapts to the current theme.
            </p>
          </div>
          <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
            <h3 class="font-medium mb-3">Another Card</h3>
            <p class="text-gray-700 dark:text-gray-300">
              All elements respond to theme changes.
            </p>
          </div>
        </div>
      </main>

      <footer
        class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700 text-center"
      >
        <p class="text-gray-600 dark:text-gray-400">Â© 2025 Theme Toggle Demo</p>
      </footer>
    </div>
  </body>
</html>